<%= render partial: 'layouts/form_errors.html.erb', locals: { item: @chapter } %>

<%= form_for(chapter) do |f| %>

  <% if try(:story) %>
    <div class="field">
      <%= f.hidden_field :story_id, :value => story.id %>
    </div>
  <% else %>
    <div class="field"><%= f.label "Story" %><br>
    <%= f.collection_select :story_id, current_user.stories, :id, :name %></div>
  <% end %>

  <div class="field"><%= f.label :name %><br>
  <%= f.text_field :name %></div>

  <div class="field"><%= f.label :objective %><br>
  <%= f.text_area :objective, size: "60x4" %></div>

  <div class="field"><%= f.label :target_word_count %><br>
  <%= f.text_field :target_word_count %></div>

  <div class="field"><%= f.label :overview %><br>
  <%= f.text_area :overview, size: "60x8" %></div>

  <div class="field"><%= f.label "Characters" %><br>
  <%= f.collection_check_boxes :character_ids, current_user.characters.order("name ASC"), :id, :name %></div>

  <br><div class="field"><strong>Create new characters:</strong></div>
  <%= f.fields_for :characters, chapter.characters.build do |character_fields| %>

    <div class="field"><%= f.label "Character name:" %><br>
    <%= character_fields.text_field :name %>

    <%= character_fields.hidden_field :user_id, value: current_user.id %>

  <% end %>
  <br>

  <div class="actions"><%= f.submit 'Submit', :class => 'btn btn-primary' %></div>

<% end %>